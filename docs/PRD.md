# Product Requirements Document (PRD)
## PoFastType - Typing Speed Test Application

### Application Overview

**PoFastType** is a modern, cloud-native typing speed test application that allows users to test their typing speed, track their progress over time, and compete on a global leaderboard. Built with .NET 9 and Blazor WebAssembly, the application provides a responsive, real-time experience optimized for both desktop and mobile devices.

#### Key Features
- **Real-Time Typing Tests**: Users type randomly generated text snippets and receive instant feedback on speed (WPM) and accuracy
- **Personal Statistics Dashboard**: Track individual performance metrics, view historical results, and monitor improvement trends
- **Global Leaderboard**: Compete with other typists worldwide with rankings based on WPM and accuracy
- **Responsive Design**: Seamless experience across desktop, tablet, and mobile devices
- **Zero-Cost Hosting**: Deployed on Azure using free-tier services (App Service Plan F1, Azure Table Storage)

#### Technical Architecture
- **Frontend**: Blazor WebAssembly (client-side rendering)
- **Backend**: ASP.NET Core 9.0 Web API
- **Database**: Azure Table Storage (NoSQL)
- **Monitoring**: Application Insights
- **CI/CD**: GitHub Actions with Azure Developer CLI
- **Infrastructure**: Azure App Service (hosted on shared F1 plan)

---

## User Interface Components

### 1. Home Page (`Home.razor`)
**Purpose**: Primary game interface where users test their typing speed

**Components**:
- **Text Display Area**: Shows the text to be typed with real-time highlighting
  - Displays random text snippet generated by the backend
  - Highlights correctly typed characters in green
  - Highlights errors in red
  - Updates in real-time as user types

- **Input Text Box**: Large, focused textarea for user input
  - Auto-focused on page load
  - Captures keystrokes in real-time
  - Disabled when game is not in progress

- **Game Controls**:
  - **Start Button**: Initiates a new typing test session
  - **Reset Button**: Clears current progress and loads new text
  - **Timer Display**: Shows elapsed time during active game

- **Results Panel** (shown after completion):
  - **WPM (Words Per Minute)**: Calculated typing speed
  - **Accuracy Percentage**: Ratio of correct characters to total characters
  - **Time Taken**: Total seconds to complete the test
  - **Character Count**: Total characters in the test text

**Functionality**:
- Fetches random text from `/api/game/text` endpoint
- Tracks typing progress character-by-character
- Calculates WPM: `(characters typed / 5) / (time in minutes)`
- Calculates accuracy: `(correct characters / total characters) × 100`
- Submits results to `/api/game/results` endpoint
- Stores user identity in browser local storage

---

### 2. Leaderboard Page (`Leaderboard.razor`)
**Purpose**: Display global rankings of top typists

**Components**:
- **Leaderboard Table**:
  - **Rank Column**: Position on the leaderboard (1, 2, 3...)
  - **Username Column**: Display name of the typist
  - **WPM Column**: Typing speed in words per minute
  - **Accuracy Column**: Accuracy percentage
  - **Date Column**: When the result was achieved

- **Filter Controls**:
  - **Time Range Selector**: Filter by today, this week, this month, all-time
  - **Limit Selector**: Show top 10, 25, 50, or 100 results

- **Refresh Button**: Manually reload leaderboard data

**Functionality**:
- Fetches top scores from `/api/scores/leaderboard?count={limit}` endpoint
- Automatically refreshes every 60 seconds
- Highlights current user's position (if in top results)
- Responsive table that converts to cards on mobile devices
- Sorted by WPM (descending), with accuracy as tiebreaker

**Mobile Optimization**:
- Desktop: Full table view with all columns
- Mobile: Card-based layout showing essential stats

---

### 3. User Stats Page (`UserStats.razor`)
**Purpose**: Personal dashboard showing individual performance history

**Components**:
- **User Profile Section**:
  - Display username
  - Total games played
  - Average WPM across all games
  - Average accuracy across all games
  - Best WPM achieved
  - Global rank (if applicable)

- **Performance Chart**:
  - Line graph showing WPM over time
  - Visual trend of improvement or decline
  - X-axis: Date/time of tests
  - Y-axis: WPM values

- **Recent Games Table**:
  - **Date/Time Column**: When the game was played
  - **WPM Column**: Speed achieved
  - **Accuracy Column**: Accuracy percentage
  - **Duration Column**: Time taken to complete

- **Statistics Cards**:
  - **Total Games**: Count of completed tests
  - **Average WPM**: Mean typing speed
  - **Best WPM**: Highest speed achieved
  - **Improvement**: Percentage change from first game

**Functionality**:
- Fetches user-specific data from `/api/scores/user/{userId}` endpoint
- Displays last 20 games in descending chronological order
- Calculates statistics client-side from returned data
- Stores user ID in browser local storage for persistence
- Shows "No games played" message for new users

---

### 4. Diagnostics Page (`Diag.razor`)
**Purpose**: System health monitoring and API connectivity testing

**Components**:
- **Health Check Dashboard**:
  - **Overall Status**: Green (Healthy) or Red (Unhealthy)
  - **Individual Health Checks**:
    1. **Internet Connection**: Tests external connectivity
    2. **Azure Connectivity**: Verifies Azure service availability
    3. **Self Health Check**: API self-test
    4. **API Endpoint**: Tests critical API endpoints
    5. **Azure Table Storage**: Database connectivity
    6. **OpenAI Service**: AI service availability (if configured)

- **API Test Panel**:
  - **Endpoint Selector**: Dropdown of available API endpoints
  - **Test Button**: Triggers manual API call
  - **Response Viewer**: Shows JSON response with syntax highlighting
  - **Status Code Display**: HTTP status code (200, 404, 500, etc.)

- **System Information**:
  - Application version
  - Environment (Development/Production)
  - Last deployment date
  - Azure region

**Functionality**:
- Polls `/api/diag/health` endpoint every 30 seconds
- Displays real-time health status with color-coded indicators
- Allows manual testing of any API endpoint
- Useful for troubleshooting deployment issues
- Accessible to all users (no authentication required)

**Health Check Logic**:
```
Green (✅) = All checks passing (HTTP 200)
Yellow (⚠️) = Some checks degraded
Red (❌) = Critical checks failing
```

---

### 5. Navigation Bar (`Navbar_New.razor`)
**Purpose**: Global navigation component present on all pages

**Components**:
- **App Logo/Title**: "PoFastType" branding with link to home
- **Navigation Links**:
  - **Home**: Navigate to typing test (`/`)
  - **Leaderboard**: View global rankings (`/leaderboard`)
  - **My Stats**: Personal dashboard (`/user-stats`)
  - **Diagnostics**: System health (`/diag`)

- **Mobile Menu**:
  - Hamburger icon for responsive navigation
  - Collapsible menu on small screens
  - Full menu on desktop/tablet

**Functionality**:
- Active link highlighting (shows current page)
- Responsive layout (hamburger menu on mobile)
- Sticky/fixed positioning at top of viewport
- Smooth transitions between pages using Blazor routing

---

## Data Flow & API Endpoints

### Game Flow
1. User clicks "Start" on Home page
2. Frontend calls `GET /api/game/text` → Returns random text snippet
3. User types the text
4. Frontend tracks WPM and accuracy in real-time
5. On completion, calls `POST /api/game/results` with:
   ```json
   {
     "userId": "guid",
     "wpm": 75,
     "accuracy": 98.5,
     "durationSeconds": 45,
     "textLength": 250
   }
   ```
6. Backend stores result in Azure Table Storage
7. Frontend displays results and offers to play again

### Leaderboard Flow
1. User navigates to Leaderboard page
2. Frontend calls `GET /api/scores/leaderboard?count=50`
3. Backend queries Azure Table Storage for top results
4. Returns sorted array of `LeaderboardEntry` objects
5. Frontend renders table/cards with rankings

### User Stats Flow
1. User navigates to User Stats page
2. Frontend retrieves userId from local storage
3. Calls `GET /api/scores/user/{userId}`
4. Backend queries all results for that user
5. Frontend calculates statistics and renders charts/tables

---

## Non-Functional Requirements

### Performance
- Page load time: < 2 seconds
- API response time: < 500ms for 95th percentile
- Real-time typing feedback: < 50ms latency
- Support up to 100 concurrent users (F1 plan limit)

### Security
- All traffic over HTTPS (TLS 1.2+)
- No authentication required (public app)
- User data stored by GUID (no PII collection)
- Input validation on all API endpoints
- Rate limiting on game result submissions

### Scalability
- Horizontal scaling via Azure App Service
- Table Storage supports millions of records
- Stateless API design (no server-side sessions)
- Client-side rendering reduces server load

### Availability
- 99.9% uptime target
- Health checks for proactive monitoring
- Automated deployment rollback on failure
- Application Insights for error tracking

### Accessibility
- WCAG 2.1 Level AA compliance
- Keyboard navigation support
- Screen reader friendly
- High contrast mode support
- Responsive design (mobile-first)

---

## Future Enhancements

### Phase 2 Features
- User accounts with authentication (Azure AD B2C)
- Custom text uploads
- Multiplayer races (real-time competition)
- Achievements and badges
- Detailed analytics (typing heatmaps, error patterns)
- Practice mode with difficulty levels
- Export personal data (CSV/JSON)

### Phase 3 Features
- Mobile native apps (iOS/Android)
- Social media sharing
- Team/organization leaderboards
- API for third-party integrations
- Theming and customization
- Offline mode with local storage
- Multi-language support

---

## Success Metrics

### User Engagement
- Daily active users (DAU)
- Average session duration
- Games played per user
- Return rate (7-day, 30-day)

### Performance Metrics
- Average API response time
- 95th percentile response time
- Error rate (< 0.1% target)
- Application availability (99.9% target)

### Business Metrics
- Total registered users (if auth added)
- Total games played
- Azure hosting costs (target: $0/month on F1 plan)
- User satisfaction (via feedback form)

---

## Technical Constraints

### Azure Free Tier Limitations
- **App Service Plan F1**:
  - 60 CPU minutes/day
  - 1 GB RAM
  - 1 GB disk space
  - No auto-scaling
  - No custom domains (HTTPS)
  - No deployment slots

- **Table Storage**:
  - 20,000 transactions/second
  - 500 TB storage
  - Pay-per-transaction (extremely low cost)

### Browser Compatibility
- Modern browsers only (last 2 versions)
- Chrome, Firefox, Edge, Safari
- No IE11 support
- WebAssembly required

---

## Deployment & Operations

### CI/CD Pipeline
- **Trigger**: Push to `master` branch
- **Steps**:
  1. Build .NET solution
  2. Run tests (excluding E2E)
  3. Deploy to Azure via `azd up`
  4. Verify health endpoint
  5. Run smoke tests

### Monitoring
- **Application Insights**:
  - Exception tracking
  - Request telemetry
  - Dependency calls
  - Custom events

- **Health Checks**:
  - `/api/health` endpoint
  - 6 health checks (Internet, Azure, API, Storage, etc.)
  - Polled by CD pipeline post-deployment

### Backup & Recovery
- Azure Table Storage auto-replication
- Git-based code versioning
- Infrastructure as Code (Bicep)
- Rollback via GitHub Actions revert

---

## Glossary

- **WPM**: Words Per Minute - Standard typing speed metric (1 word = 5 characters)
- **Accuracy**: Percentage of correctly typed characters
- **Partition Key**: Azure Table Storage row organization (userId in this app)
- **Row Key**: Unique identifier within partition (timestamp in this app)
- **Blazor WASM**: Blazor WebAssembly - Client-side rendering framework
- **azd**: Azure Developer CLI - Deployment automation tool
- **F1 Plan**: Free tier App Service plan (shared resources)

---

**Document Version**: 1.0  
**Last Updated**: October 27, 2025  
**Owner**: Development Team  
**Status**: Active
